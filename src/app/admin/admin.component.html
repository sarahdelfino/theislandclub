<section *ngIf="!(loading$ | async); else loading">
  <div class="table-container">
    <table mat-table [dataSource]="dataSource" matSort>

      <!-- Date -->
      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Date</th>
        <td mat-cell *matCellDef="let e">{{ e.date | date: 'MMM d, y' }}</td>
      </ng-container>

      <!-- Title -->
      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Event</th>
        <td mat-cell *matCellDef="let e">{{ e.title }}</td>
      </ng-container>

      <!-- Organizer -->
      <ng-container matColumnDef="organizer">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Organizer</th>
        <td mat-cell *matCellDef="let e">
          {{ e.organizer }}
        </td>
      </ng-container>

      <!-- Status -->
      <ng-container matColumnDef="state">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
        <td mat-cell *matCellDef="let e">
          <mat-chip
            [color]="e.state === 'approved' ? 'primary' : 'warn'"
            selected
          >
            {{ e.state }}
          </mat-chip>
        </td>
      </ng-container>

      <!-- Agreement -->
      <ng-container matColumnDef="agreement">
        <th mat-header-cell *matHeaderCellDef>Agreement</th>
        <td mat-cell *matCellDef="let e">
          <button
            mat-icon-button
            color="primary"
            [disabled]="!e.document"
            (click)="openAgreement(e.document.agreementPdfUrl)"
            matTooltip="Open Agreement"
          >
            <mat-icon>description</mat-icon>
          </button>
          <mat-chip
            *ngIf="e.agreementSigned"
            color="accent"
            selected
            class="status-chip"
          >
            Signed
          </mat-chip>
        </td>
      </ng-container>

      <!-- Cleaning Fee -->
      <ng-container matColumnDef="cleaningFee">
        <th mat-header-cell *matHeaderCellDef>Cleaning Fee</th>
        <td mat-cell *matCellDef="let e">
          <button
            mat-icon-button
            color="primary"
            [disabled]="!e.cleaningFeeUrl"
            (click)="openPayment(e.cleaningFeeUrl)"
            matTooltip="Open Payment"
          >
            <mat-icon>payment</mat-icon>
          </button>
          <mat-chip
            *ngIf="e.cleaningFeePaid"
            color="accent"
            selected
            class="status-chip"
          >
            Paid
          </mat-chip>
        </td>
      </ng-container>

      <!-- Actions -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let e">
          <button style="color: white; font-weight: 500;" [disabled]="e.state === 'approved'" mat-raised-button color="primary" (click)="approve(e.id)">
            Approve
          </button>
          <button mat-stroked-button color="accent" (click)="requestInfo(e.id)">
            Email
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>

    <mat-paginator [pageSize]="10"></mat-paginator>
  </div>
</section>

<ng-template #loading>
  <div class="loading">Loading eventsâ€¦</div>
</ng-template>
